10 POKE 53280,6: POKE 53281,6
20 GOSUB 2200 : rem init SID
30 GOSUB 2600 : rem Intro
40 DIM R(4),S(7,7):G=-1:R(0)=-99
50 GOSUB 2400 : rem Prepare/init board
60 GOSUB 3000 : rem POKE the ML code
65 PRINT "{light blue}{clear}": XU=0: YU=2 : SM = 1024 : QM = 55296
70    GOSUB 2000  : rem DRAW BOARD
80    GOSUB 140  : rem CHECK THE BOARD
90    GOSUB 400  : rem COMPUTER MOVES
100   GOSUB 2000 : rem DRAW BOARD
110   GOSUB 500  : rem Check pieces
120   GOSUB 600  : rem Get player's move
130   GOTO 70
140 PRINT "{home}{light blue}{down*20}{space*20}";
145 PRINT "{left*20}thinking..."
150 FOR X=0 TO 7
160   FOR Y=0 TO 7
170     IF S(X,Y)>-1 THEN 270
180     IF S(X,Y)=-2 THEN 230
190     FOR A=-1 TO 1 STEP 2     :REM S(X,Y)=-1
200       B=G
210       GOSUB 310
220     NEXT A
230     FOR A=-1 TO 1 STEP 2     :REM S(X,Y)=-2
240       FOR B=-1 TO 1 STEP 2
250         GOSUB 310
260     NEXT B,A
270   NEXT Y
280 NEXT X
290 PRINT "{up}{space*20}"
300 RETURN
310 U=X+A
320 V=Y+B
330 IF U<0 OR U>7 OR V<0 OR V>7 THEN 390
340 IF S(U,V)=0 THEN GOSUB 850 : GOTO 390
350 IF S(U,V)<0 THEN 390
360 U=U+A:V=V+B
370 IF U<0 OR V<0 OR U>7 OR V>7 THEN 390
380 IF S(U,V)=0 THEN GOSUB 850
390 RETURN
400 IF R(0)=-99 THEN 2900 : rem player wins
410 PRINT "{up}from"R(1);",";R(2)"to"R(3);",";R(4);:R(0)=-99
420 IF R(4)=0 THEN S(R(3),R(4))=-2:GOTO 490
430 S(R(3),R(4))=S(R(1),R(2))
440 S(R(1),R(2))=0:IF ABS(R(1)-R(3))<>2 THEN 490
450 S((R(1)+R(3))/2,(R(2)+R(4))/2)=0
460 X=R(3):Y=R(4):IF S(X,Y)=-1 THEN B=-2:FOR A=-2 TO 2 STEP 4:GOSUB 810
470 IF S(X,Y)=-2 THEN FOR A=-2 TO 2 STEP 4:FOR B=-2 TO 2 STEP4:GOSUB810:NEXT B
480 NEXT A:IF R(0)<>-99 THEN PRINT"to"R(3);R(4);:R(0)=-99:GOTO 420
490 RETURN
500 FOR L=0 TO 7
510   FOR M=0 TO 7
520     IF S(L,M)=1 OR S(L,M)=2 THEN Z=1
530     IF S(L,M)=-1 OR S(L,M)=-2 THEN T=1
540   NEXT M
550 NEXT L
560 IF Z<>1 THEN 2900
570 IF T<>1 THEN 2950
580 Z=0: T=0
590 RETURN
600 PRINT "{home}{yellow}{down*20}{space*20}{left*20}from:";
610 GOSUB 1000: E=XU: H=YU:  rem INPUT "{yellow}from";E,H
620 X=E:Y=H
630 IF S(X,Y)<=0 THEN GOSUB 2300: GOTO 600
640 PRINT "{home}{yellow}{down*20}{space*20}{left*20}to:";
650 GOSUB 1000: A=XU: B=YU:  rem INPUT "to";A,B
660 X=A:Y=B
670 IF S(X,Y)=0 AND ABS(A-E)<=2 AND ABS(A-E)=ABS(B-H)THEN 690
680 GOSUB 2300: GOTO 640
690 I=46
700 S(A,B)=S(E,H)
710 S(E,H)=0
720 IF ABS(E-A)<>2 THEN 790
730 S((E+A)/2,(H+B)/2)=0
740 PRINT "{home}{yellow}{down*20}{space*20}";
742 PRINT "{left*20}+to:...(x to end)"
745 GOSUB 1000: A1=XU: B1=YU:   rem INPUT "+to";A1,B1
750 IF A1<0 THEN 790
760 IF S(A1,B1)<>0 OR ABS(A1-A)<>2 OR ABS(B1-B)<>2 THEN 740
770 E=A: H=B: A=A1: B=B1: I=I+15
780 GOTO 700
790 IF B=7 THEN S(A,B)=2
800 RETURN
810 U=X+A:V=Y+B
820 IF U<0 OR U>7 OR V<0 OR V>7 THEN 840
830 IF S(U,V)=0 AND S(X+A/2,Y+B/2)>0 THEN GOSUB 850
840 RETURN
850 IF V=0 AND S(X,Y)=-1 THEN Q=Q+2
860 IF ABS(Y-V)=2 THEN Q=Q+5
870 IF Y=7 THEN Q=Q-2
880 IF U=0 OR U=7 THEN Q=Q+1
890 FOR C=-1 TO 1 STEP 2
900   IF U+C<0 OR U+C>7 OR V+G<0 THEN 940
910   IF S(U+C,V+G)<0 THEN Q=Q+1: GOTO 940
920   IF U-C<0 OR U-C>7 OR V-G>7 THEN 940
930   IF S(U+C,V+G)>0 AND(S(U-C,V-G)=0 OR(U-C=X AND V-G=Y))THEN Q=Q-2
940 NEXT C
950 IF Q>R(0)THEN R(0)=Q:R(1)=X:R(2)=Y:R(3)=U:R(4)=V
960 Q=0
970 RETURN
1000 XS = XU*3+2 : YS = 15-YU*2 
1010 PU = SM+XU*3+2+(15-YU*2)*40
1020 PQ = QM+XU*3+2+(15-YU*2)*40
1030 OC = PEEK(PQ)
1040 P0 = PEEK(PU)
1050 P1 = PEEK(PU+1)
1060 P2 = PEEK(PU+2)
1070 P3 = PEEK(PU+40)
1080 P4 = PEEK(PU+41)
1090 P5 = PEEK(PU+42)
1100 RV = -128*(P0<160)
1110 POKE PU,(RV+P0)AND255
1120 POKE PU+1,(RV+P1)AND255
1130 POKE PU+2,(RV+P2)AND255
1140 POKE PU+40,(RV+P3)AND255
1150 POKE PU+41,(RV+P4)AND255
1160 POKE PU+42,(RV+P5)AND255
1170 POKE PQ,8: POKE PQ+1,8:POKE PQ+2,8:POKE PQ+40,8:POKE PQ+41,8:POKE PQ+42,8 
1180 GET K$ : IF K$="" GOTO 1180
1190 POKE PU,P0
1200 POKE PU+1,P1
1210 POKE PU+2,P2
1220 POKE PU+40,P3
1230 POKE PU+41,P4
1240 POKE PU+42,P5
1250 POKE PQ,OC: POKE PQ+1,OC: POKE PQ+2,OC
1260 POKE PQ+40,OC: POKE PQ+41,OC: POKE PQ+42,OC 
1270 K = ASC(K$)
1280 IF K=145 THEN YU = YU+1 : IF YU>7 THEN YU = 7 
1290 IF K=17 THEN YU = YU-1 : IF YU<0 THEN YU = 0
1300 IF K=157 THEN XU = XU-1: IF XU<0 THEN XU = 0
1310 IF K=29 THEN XU = XU+1 : IF XU>7 THEN XU=7
1320 IF K=13 THEN RETURN
1325 IF K=88 THEN XU=-1: RETURN
1330 GOTO 1000
2000 CB = 828
2010 FOR Y=7 TO 0 STEP -1
2020   FOR X=0 TO 7
2030     SS=S(X,Y)
2040     IF SS<0 THEN SS=256+SS
2050     POKE CB,SS
2060     CB = CB+1
2070  NEXT
2080 NEXT
2090 rem PRINT "{light blue}{home}"
2100 SYS 49152
2110 RETURN
2200 v1 = 54272 : v2 = v1+7 : v3 = v2+7 : vol = v1+24
2210 pl = 2 : ph = 3: wv = 4 : ad = 5 : sr = 6
2220 for i=0 to 28 : poke v1+i,0 : next
2230 return
2300 poke vol,15
2310 poke v1+1,10        : rem freq
2320 poke v1+ad,7*16   : rem BUZZ
2330 poke v1+sr,15*16+12
2340 poke v1+wv,32+1     : rem voice #1 -> trigger attack
2350 poke v1+wv,32       : rem voice #1 -> release
2360 return
2400 DATA 1,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,-1
2410 FOR X=0 TO 1
2420   FOR Y=0 TO 7
2430     READ J
2440     S(X,Y)=J
2450     S(X+2,Y)=J
2460     S(X+4,Y)=J
2470     S(X+6,Y)=J
2480   NEXT Y
2490 NEXT X
2500 RETURN
2600 PRINT "{clear}{white}            c h e c k e r s"
2610 PRINT "{purple}             from the book"
2620 PRINT "basic computer games for microcomputers"
2630 PRINT:PRINT:PRINT
2640 PRINT "{light blue}     this is the game of checkers."
2650 PRINT
2660 PRINT " the computer is {black}black{light blue}, and you are {pink}red.{light blue}"
2670 PRINT "     the computer will move first."
2680 PRINT
2690 PRINT "       squares are referred to by"
2700 PRINT "          a coordinate system."
2710 PRINT "      a1 is the lower left corner"
2720 PRINT "      a8 is the upper left corner"
2730 PRINT "      h0 is the lower right corner"
2740 PRINT "      h8 is the upper right corner"
2750 PRINT
2760 PRINT "      the computer will type '+to'"
2770 PRINT "        when you have another jump"
2780 PRINT "       type two negative numbers"
2790 PRINT "           if you cannot jump."
2800 PRINT
2810 RETURN
2900 PRINT: PRINT "you win.": END
2950 PRINT: PRINT "i win.": END
3000 SA = 49152
3010 FOR N = 0 TO 348
3020 READ A% : POKE SA+N,A%: NEXT N
3030 RETURN
3040 DATA 169,100,162,2,157,0,4,232
3050 DATA 224,26,208,248,162,0,169,0
3060 DATA 141,59,193,141,58,193,141,56
3070 DATA 193,169,8,141,54,193,169,2
3080 DATA 141,55,193,173,56,193,32,205
3090 DATA 192,160,0,173,55,193,201,1
3100 DATA 240,8,173,54,193,24,105,48
3110 DATA 145,251,200,169,103,145,251,200
3120 DATA 169,8,141,57,193,174,59,193
3130 DATA 189,60,3,240,26,201,1,240
3140 DATA 11,169,0,32,254,192,32,13
3150 DATA 193,76,129,192,169,2,32,254
3160 DATA 192,32,13,193,76,129,192,173
3170 DATA 58,193,41,1,240,11,169,14
3180 DATA 32,254,192,32,230,192,76,129
3190 DATA 192,169,14,32,254,192,32,242
3200 DATA 192,238,58,193,238,59,193,206
3210 DATA 57,193,208,185,169,116,145,251
3220 DATA 238,56,193,206,55,193,240,12
3230 DATA 173,59,193,24,233,7,141,59
3240 DATA 193,76,35,192,238,58,193,206
3250 DATA 54,193,240,3,76,30,192,169
3260 DATA 99,162,2,157,168,6,232,224
3270 DATA 26,208,248,162,3,169,1,24
3280 DATA 157,208,6,105,1,232,232,232
3290 DATA 224,27,208,244,96,24,109,56
3300 DATA 193,170,189,61,193,133,251,133
3310 DATA 253,232,189,61,193,133,252,24
3320 DATA 105,212,133,254,232,96,169,32
3330 DATA 145,251,200,145,251,200,145,251
3340 DATA 200,96,169,160,145,251,200,145
3350 DATA 251,200,145,251,200,96,140,60
3360 DATA 193,145,253,200,145,253,200,145
3370 DATA 253,172,60,193,96,173,55,193
3380 DATA 201,1,240,18,169,85,145,251
3390 DATA 200,169,64,145,251,200,169,73
3400 DATA 145,251,200,76,53,193,169,74
3410 DATA 145,251,200,169,64,145,251,200
3420 DATA 169,75,145,251,200,96,0,0
3430 DATA 0,0,0,0,0,40,4,80
3440 DATA 4,120,4,160,4,200,4,240
3450 DATA 4,24,5,64,5,104,5,144
3460 DATA 5,184,5,224,5,8,6,48
3470 DATA 6,88,6,128,6

